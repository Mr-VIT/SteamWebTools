// ==UserScript==
// @name		Steam Web Tools
// @namespace	http://v1t.su/projects/steam/webtools/
// @description	Useful tools in Steam web sites
// @author		Mr-VIT
// @homepageURL	http://v1t.su/projects/steam/webtools/
// @icon		http://mr-vit.github.io/SteamWebTools/icon-64.png
// @run-at		document-end
// @include		http://store.steampowered.com/*
// @include		https://store.steampowered.com/*
// @include		http://steamcommunity.com/*
// @include		https://steamcommunity.com/*
// @exclude		https://steamcommunity.com/dev*
// @version		0.9
// @date		2020-05-13
// @updateURL	https://raw.githubusercontent.com/Mr-VIT/SteamWebTools/master/release/version.gm.js
// ==/UserScript==

!function(){var _=window.unsafeWindow||window,f={locales:["en","ru","jp","zh-cn"],defaults:{version:1,globalLang:"en",globalFixNavbar:!0,globalHideWalletBalance:!0,globalDisableLinkFilted:!1,storeShowCCbtn:!0,storeCCList:"ru ua us ar fr no gb au br de jp",storeShowCartBtn:!0,storeCartAjax:!0,storeShowSubid:!0,storeShowBtnGetPrices:!0,marketMainPageFuncs:!0,invSellItemPriceCheckMaxDiscount:25},cur:{},storage:{key:"SWTSettings",gm:!!window.GM_getValue,set:function(e){this.gm?GM_setValue(this.key,e):_.localStorage.setItem(this.key,e)},get:function(){return this.gm?GM_getValue(this.key):_.localStorage.getItem(this.key)},del:function(){this.gm?GM_deleteValue(this.key):_.localStorage.removeItem(this.key)}},load:function(){this.cur=_.$J.extend({},this.defaults);var e=this.storage.get();if(e)"string"==typeof e&&(e=JSON.parse(e)),_.$J.extend(this.cur,e);else{var t,a=_.navigator.language.toLowerCase();if(-1<(t=this.locales.indexOf(a)))this.cur.globalLang=this.locales[t];else if(1<(a=a.split("-")).length)-1<(t=this.locales.indexOf(a[0]))&&(this.cur.globalLang=this.locales[t]);this.save();var i={outline:"#48DA48 3px solid"},n=_.$J("#global_header .menuitem.supernav:nth(1)");n.css(i),setTimeout(function(){n.trigger("mouseover")},1e3),setTimeout(function(){_.$J("#global_header .submenu_community .submenuitem.swt").css(i)},2e3)}},save:function(){this.cur&&this.storage.set(JSON.stringify(this.cur))},reset:function(){this.storage.del(),this.cur=this.defaults}};function v(e){return v.text[e]||e}if(f.load(),_.swt_settings=f,v.loadText=function(e){this.text?e["lang.code"]==f.cur.globalLang&&_.$J.extend(this.text,e):this.text=e},v.loadText({"lang.current":"English","lang.code":"en",getMoreInfo:"Get more Info",extInfo:"Extended Info",reqErr:"Request Error",checkin:"Check in",searchinforums:"Search in forums",inventory:"Inventory",toInventory:"To Inventory",profile:"Profile",trades:"Trades",chat:"Chat",more:"More",showDropsCard:"Show only with cards drops remaining",craftAllAvailable:"Craft all available",craftAllAvailableConfirm:"Are you sure you want to start crafting all available badges?",howmany:"How many? of ",save:"Save",get:"Get",checkForSend:"Check for send",sendChecked:"Send checked",showNote:"Show Note",minMarketPrice:"Min. Market price",hideDup:"Hide duplicates, show amount",go:"Go",checkAll:"Check all",deleteChecked:"Delete checked",addSubidsToCart:"Add SubIDs to cart",add:"Add",addChecked:"Add checked",cartHist:"Cart history",quickPurchase:"One-Click Buy to inventory (SteamWallet only)",giftForSend:"Gifts for send",giftForSendNote:"If you want to send Gifts to different Emails enter them below one per line. Gifts will be sent on the order. If quantity of gifts greater than address the remaining Gifts will be sent to the last address",sent:"Sent",getPrices:"Get prices for other countries",prices:"Prices for other countries",viewin:"View in",searchin:"Search in",viewMyCardsGame:"View my cards/badge this game",SearchCardsOnMarket:"Search cards on Market",adding:"adding",added:"Added | View in cart",balance:"Balance",acceptAllToInv:"Accept all to inventory",listed:"Listed: ",skipped:"Skipped: ",setlowestprice:"set lowest price",skipSent:"Skip gifts sent before?",totop:"To top","set.ext":"extension","set.settings":"Settings","set.homePage":"Home Page","set.global":"Global","set.lang":"Language","set.hideBalance":"Hide Wallet Balance. It will be displayed in the tooltip when you hover.","set.store":"Store","set.showCCBtn":"Show button change country","set.CCList":"Your list of countries. Enter your country first","set.showCartBtn":"Always show Cart button","set.cartAjax":"Adding to cart without reloading the page","set.showSubid":"Show SubID","set.showBtnGetPrices":'Show button "Get prices for other countries"',"set.def":"Restore the default","set.market":"Community Market","set.marketMainPageFuncs":"Enable functions in main page of Community Market","set.FixNavbar":"Fix Navbar","set.linkfilter":"Disable link filter alert","rep.unk":"unknown","rep.mdlman":"middleman","rep.white":"whitelisted","rep.black":"blacklisted","rep.orange":"suspicious","set.sellLowPriceCheck":"Request confirmation to sell an item if the entered price is lower than the current selling price by this % percentage. (0 - off)","sellLowPriceCheck.warnTitle":"Steam Web Tools - ⚠Warning:\n","sellLowPriceCheck.warning":"You specify the price much lower than the current one. Are you sure you want to list the item at your price?","sellLowPriceCheck.warning2":"To continue, confirm the sale price by entering it","sellLowPriceCheck.loadErr":"Failed to get current item price. Check the entered and the current price yourself. List the item at your price?"}),v.loadText({"lang.current":"Русский","lang.code":"ru",getMoreInfo:"Получить больше Информации",extInfo:"Расширенная Информация",reqErr:"Ошибка при получении данных",checkin:"Проверить на",searchinforums:"Искать на форумах",inventory:"Инвентарь",toInventory:"В Инвентарь",profile:"Профиль",trades:"Трэйды",chat:"Чат",more:"Ещё",showDropsCard:"Показать с невыпавшими картами",craftAllAvailable:"Крафт всех доступных",craftAllAvailableConfirm:"Вы уверены, что хотите запустить крафт всех доступных значков?",howmany:"Сколько выбрать? из ",save:"Сохранить",get:"Получить",checkForSend:"Выбрать для отправки",sendChecked:"Отправить выбранные",showNote:"Посмотреть заметку",minMarketPrice:"Мин цена на маркете",hideDup:"Прятать дубликаты, показывая кол-во",go:"Перейти",checkAll:"Выбрать все",deleteChecked:"Удалить выбранные",addSubidsToCart:"Добавить SubID'ы в корзину",add:"Добавить",addChecked:"Добавить выбранные",cartHist:"История корзины",quickPurchase:"Купить в инвентарь за один клик (только со Steam Кошелека)",giftForSend:"Гифты для отправки",giftForSendNote:"Если хотите отправить гифты на разные Email введите их ниже по одному на строку. Гифты будут отправленны по порядку. Если гифтов больше чем адресов, оставшиеся гифты будут отправлены на последний адрес",sent:"Отправлен",getPrices:"Получить цены для других стран",prices:"Цены для других стран",viewin:"Посмотреть на",searchin:"Искать на",viewMyCardsGame:"Посмотреть мои карты/значек этой игры",SearchCardsOnMarket:"Найти карточки на Торг.пл.",adding:"добавление",added:"Добавлено | Корзина",balance:"Баланс",acceptAllToInv:"Принять все в инвентарь",listed:"Выставлено: ",skipped:"Пропущено: ",setlowestprice:"установить минимальную цену",skipSent:"Пропустить отправленные ранее?",totop:"Наверх","set.ext":"расширение","set.settings":"Настройки","set.homePage":"Домашняя страница","set.global":"Глобальные","set.lang":"Язык","set.hideBalance":"Скрывать баланс кошелька. Будет показываться в подсказке при наведении","set.store":"Магазин","set.showCCBtn":"Показывать кнопку переключения страны","set.CCList":"Ваш список стран. Вашу страну укажите первой","set.showCartBtn":"Показывать кнопку корзины, даже если она пуста","set.cartAjax":"Добавлять в корзину без перезагрузки страницы","set.showSubid":"Отображать номер подписки","set.showBtnGetPrices":"Показывать кнопку получения цен для других стран","set.def":"Восстановить по умолчанию","set.market":"Торговая Площадка","set.marketMainPageFuncs":"Включить надстройку на главной странице торговой площадки","set.FixNavbar":"Зафиксировать Меню Навигации","set.linkfilter":"Отключить предупреждение фильтра ссылок","rep.unk":"неизвестен","rep.mdlman":"гарант","rep.white":"в белом списке","rep.black":"в черном списке","rep.orange":"подозрительный","set.sellLowPriceCheck":"Запрашивать подтверждение продажи если введенная цена ниже продаваемого на этот % (0 - выкл)","sellLowPriceCheck.warnTitle":"Steam Web Tools - ⚠Предупреждает:\n","sellLowPriceCheck.warning":"Указанная вами цена сильно ниже текущей. Вы уверены, что хотите выставить предмет по такой цене?","sellLowPriceCheck.warning2":"Для продолжения подтвердите вводом цену продажи","sellLowPriceCheck.loadErr":"Не удалось получить текущую цену на предмет. Самостоятельно проверьте текущую и введеную цену. Выставить предмет по вашей цене?"}),v.loadText({"lang.current":"简体中文","lang.code":"zh-cn",getMoreInfo:"获取更多信息",extInfo:"详细信息",reqErr:"请求失败",checkin:"查询声誉",searchinforums:"搜索论坛",inventory:"查询库存",profile:"查询资料",trades:"查询交易",chat:"聊天",more:"更多",showDropsCard:"只查看可掉卡游戏",howmany:"多少个? 总共 ",save:"保存",get:"获取",checkForSend:"选中",sendChecked:"发送所选",showNote:"显示备忘",minMarketPrice:"最低市场价格",hideDup:"合并重复项并显示数量",go:"跳转",checkAll:"全选",deleteChecked:"删除选中",addSubidsToCart:"添加 SubIDs 到购物车",add:"添加",addChecked:"添加选中",cartHist:"购物车历史记录",quickPurchase:"一键购买到库存 (只支持 Steam 钱包)",giftForSend:"准备发送的礼物",giftForSendNote:"如果想给不同的 Email 地址发送礼物,请在下框中每行填写一个 Email. 礼物将按顺序发送. 如果礼物数量大于 Email 地址数, 余下的礼物将被全部发送到最后一个地址.",sent:"已发送",getPrices:"获取其他地区的价格",prices:"其他地区价格",viewin:"查询",searchin:"搜索",viewMyCardsGame:"查看该游戏的卡片/徽章",adding:"正在添加",added:"已添加 | 在购物车中查看",balance:"余额",acceptAllToInv:"接受全部并加入库存","set.ext":"扩展","set.settings":"设置","set.homePage":"主页","set.global":"全局","set.lang":"语言","set.hideBalance":"隐藏余额. 鼠标停留在[余额]上时显示.","set.store":"商店","set.showCCBtn":"显示区域切换按钮(需要登出)","set.CCList":"区域列表. 将主区域放在第一位.","set.showCartBtn":"总是显示购物车按钮","set.cartAjax":"添加到购物车时不重新加载页面","set.showSubid":"显示 SubID","set.showBtnGetPrices":'显示 "获取其他地区的价格" 按钮(需要登出)',"set.def":"恢复默认"}),v.loadText({"lang.current":"日本語","lang.code":"jp",getMoreInfo:"詳細",extInfo:"拡張機能について",reqErr:"リクエストエラー",checkin:"チェックイン",searchinforums:"フォーラムで探す",inventory:"インベントリ",profile:"プロフィール",trades:"トレード",chat:"チャット",more:"詳細",save:"セーブ",checkForSend:"選択して送信",sendChecked:"選択したものを送信する",showNote:"メモを見る",checkAll:"すべて選択",deleteChecked:"選択を解除",sent:"送信完了",getPrices:"国ごとの価格を表示",prices:"国ごとの価格","set.ext":"拡張機能","set.settings":"設定","set.homePage":"ホームページ","set.global":"グローバル","set.lang":"言語","set.hideBalance":"残高を非表示にする","set.store":"ストア","set.showSubid":"SubIDを表示","set.showBtnGetPrices":'"国ごとの価格を表示"ボタンを表示する',"set.market":"マーケット"}),_.$J(".submenu_community").append('<a class="submenuitem swt" href="https://steamcommunity.com/groups/SteamClientBeta#/swt-settings">SWT - '+v("set.settings")+"</a>"),f.cur.globalFixNavbar){_.$J("head").append("<style>#global_header.swtfixed{position:fixed;z-index:9999;width:100%}.responsive_page_template_content.swtfixed{padding-top:50px}#global_header.swtfixed>.content{height:50px !important}#global_header.swtfixed div.logo{display:none}#global_header.swtfixed .menuitem{padding-top:15px !important}#global_header.swtfixed .supernav_container{left:0 !important}#global_header.swtfixed .header_installsteam_btn{display:none}.swtup{display:none}#global_header.swtfixed .swtup{display:block;float:left}</style>");var e=_.$J("#global_header");if(e.length){e.prepend('<a class="swtup" href="#"><span class="btn_grey_white_innerfade btn_medium_wide"><span>'+v("totop")+"</span></span></a>");var t=e.offset().top;_.document.onscroll=function(){_.$J(window).scrollTop()>t?(_.$J("#global_header").addClass("swtfixed"),_.$J(".responsive_page_template_content").addClass("swtfixed")):(_.$J("#global_header").removeClass("swtfixed"),_.$J(".responsive_page_template_content").removeClass("swtfixed"))}}}for(var a="https?://store\\.steampowered\\.com/",i="https?://steamcommunity\\.com/",n=[{match:[a+"cart.*"],run:function(){var r=_.$J,e=document.querySelector(".page_content > .rightcol");links=[{href:"https://store.steampowered.com/checkout/?purchasetype=gift#quick",blank:1,text:v("quickPurchase")}],e.insertAdjacentHTML("afterBegin",function(e,t){for(var a,i="<h2>"+e+'</h2><div class="block"><div class="block_content">',n=0;n<t.length;n++)i+='<a class="btn_small btnv6_blue_hoverfade" href="'+(a=t[n]).href+'"'+(a.blank?' target="_blank"':"")+"><span>"+a.text+"</span></a><br/>";i+="<br/><h2>"+v("addSubidsToCart")+'</h2> <form id="addtocartsubids" method="post"><input type="hidden" name="sessionid" value="'+_.g_sessionID+'"><input type="hidden" name="action" value="add_to_cart"><input type="text" name="subids" placeholder="1, 2, 3"/><input type="submit" value="'+v("add")+'" class="btn_small btnv6_blue_hoverfade"></form><br><form id="formcarthist" method="post"><input type="submit" value="'+v("addChecked")+'" style="float:right" class="btn_small btnv6_blue_hoverfade"><h2>'+v("cartHist")+'</h2><input type="hidden" name="sessionid" value="'+_.g_sessionID+'"><input type="hidden" name="action" value="add_to_cart">';var r=_.localStorage.swtcarthistory&&JSON.parse(_.localStorage.swtcarthistory)||[],o="";for(n=0;n<r.length;n++)o='<input type="checkbox" name="subid[]" value="'+r[n].subid+'">  <a href="/'+(r[n].link||"sub/"+r[n].subid)+'/">'+(r[n].name||"SubID: "+r[n].subid)+'</a><br>[<a href="/sub/'+r[n].subid+'/">'+r[n].subid+"</a>] ("+(r[n].price||"N/A")+")<br><br>"+o;return i+=o+"</form></div></div>"}("Steam Web Tools",links)),r("#addtocartsubids").bind("submit",function(){var e,t=r(this),a=t.find('input[name="subids"]').val(),i=_.localStorage.swtcarthistory&&JSON.parse(_.localStorage.swtcarthistory)||[];a=a.split(",");for(var n=0;n<a.length;n++)e=a[n].trim(),t.append('<input type="hidden" name="subid[]" value="'+e+'"/>'),i.push({subid:e});for(;20<i.length;)i.shift();_.localStorage.swtcarthistory=JSON.stringify(i)})}},{match:[a+"checkout/\\?purchasetype=.+"],run:function(){if(_.$("accept_ssa").checked=!0,-1<_.location.search.indexOf("purchasetype=gift")){var e;if(!_.$("send_self"))if(e=document.cookie.match(/steamRememberLogin=(\d{17})/)){e=e[1];var a=parseInt(e.substr(-10),10)-7960265728,i=_.SelectGiftRecipient;_.SelectGiftRecipient=function(e,t){return e!=a&&(_.$("send_self").checked=!1),i.apply(this,arguments)},_.$J("#current_friend_choice").after('<div class="cart_send_choice checkout_content"><input class="send_choice_radio" type="radio" id="send_self" name="send_method" onchange="if(this.checked)SelectGiftRecipient('+a+',\'\');CheckFriendDisplay();"><label for="send_self" class="send_choice_txt"> '+v("toInventory")+"</label></div>")}var t=_.$("send_self");t.checked=!0,t.onchange()}}},{match:[a+"checkout/\\?purchasetype=gift.*"],run:function(){if("#quick"==_.location.hash){var e=_.FinalizeTransaction;_.FinalizeTransaction=function(){return _.$("accept_ssa").checked=!0,e.apply(this,arguments)};var t=_.OnGetFinalPriceSuccess;_.OnGetFinalPriceSuccess=function(){var e=t.apply(this,arguments);return _.FinalizeTransaction(),e},_.InitializeTransaction()}}},{match:[a+"checkout/sendgift/.*",a+"checkout/\\?purchasetype=gift.*"],run:function(){var e=document.querySelectorAll(".friend_block.disabled");if(e){for(var t=document.querySelectorAll(".friend_block_radio input[disabled]"),a=0;a<e.length;a++)e[a].removeClassName("disabled"),t[a].disabled=!1;if(_.location.hash&&"multisend"==_.location.hash.substr(1,9)){var i=_.location.hash.substr(11,_.location.hash.lenght);i=JSON.parse(decodeURIComponent(i));var n=document.querySelector(".checkout_tab"),r=[],o=[],s="";a=0;for(var c in i)r.push(c),o.push(i[c]),s+="<p>"+i[c]+' <span id="giftN'+a+'"></span></p>',a++;n.innerHTML="<p><b>"+v("giftForSend")+": "+r.length+"</b></p>"+s,_.$("email_input").insertAdjacentHTML("afterEnd","<br/><br/>"+v("giftForSendNote")+'<br/><textarea id="emails" rows=3></textarea>');var l=0,d=[];_.g_gidGift=r[0];var m=_.SubmitGiftDeliveryForm;_.SubmitGiftDeliveryForm=function(){return _.$("send_via_email").checked&&_.$("emails").value&&(d=_.$("emails").value.split(/\r?\n/)).length&&(_.$("email_input").value="noreply@steampowered.com"),m.apply(this,arguments)};var p=_.SubmitGiftNoteForm;_.SubmitGiftNoteForm=function(){return d.length&&(_.$("email_input").value=d[0]),p.apply(this,arguments)};var u=_.OnSendGiftSuccess;_.OnSendGiftSuccess=function(){_.$("giftN"+l).innerHTML="- "+v("sent"),(_.g_gidGift=r[++l])?(1<d.length&&(_.$("email_input").value=d[Math.min(l,d.length-1)]),_.SendGift()):u.apply(this,arguments)}}}}},{match:[a+".*"],run:function(){var g=_.$J;_cc={curCC:!1,updHTMLccList:function(e){var t="";_cc.ListA=f.cur.storeCCList.split(" ");for(var a=0;a<_cc.ListA.length;a++)t+='<a class="popup_menu_item" href="'+_cc.url+_cc.ListA[a]+'"><img src="//steamcommunity-a.akamaihd.net/public/images/countryflags/'+_cc.ListA[a]+'.gif" style="width:16px"/> '+_cc.ListA[a].toUpperCase()+"</a>";document.getElementById("cc_list").innerHTML=t,_cc.curCC=e||_cc.ListA[0]},url:String(_.location)},-1==_cc.url.indexOf("?")?_cc.url+="?":_cc.url=_cc.url.replace(/\?.+/,"?"),_cc.url+="cc=",_._cc=_cc,function(){f.cur.globalHideWalletBalance&&(u=g("#header_wallet_balance")[0])&&(u.title=u.innerHTML,u.innerHTML="["+v("balance")+"]"),f.cur.storeShowCartBtn&&g("#store_header_cart_btn").css("display","block");var e=document.getElementById("global_action_menu");if(e){var t=!1;(t=document.cookie.match(/steamCountry=(\w{2})/i))&&(t=t[1]);var a="\t\t\t\t\t<style>#cc_menu_btn{display:none;min-width:59px;z-index:999}#cc_list .popup_menu_item{white-space:nowrap}</style>\t\t\t\t\t<span class=\"pulldown\" id=\"cc_menu_btn\" onclick=\"ShowMenu(this, 'cc_menu', 'left', 'bottom', true);\">CC"+(t?': <img src="//steamcommunity-a.akamaihd.net/public/images/countryflags/'+t.toLowerCase()+'.gif" /> '+t:"")+' </span>\t\t\t<div class="popup_block_new" id="cc_menu" style="display:none;">\t\t\t<div class="popup_body popup_menu shadow_content" id="cc_list"></div></div>';e.insertAdjacentHTML("afterBegin",a),_cc.updHTMLccList(t)}f.cur.storeShowCCbtn&&g("#cc_menu_btn").show();var i=String(_.location.href).match(/\/(sub|app)\/(\d+)/i);if(i){var n=i[1],r=i[2],o=document.querySelectorAll(".game_area_purchase_game");if(f.cur.storeShowSubid||f.cur.storeShowBtnGetPrices){for(var s,c,l=[],d=0;d<o.length;d++)(u=o[d].querySelector('input[name="subid"]'))&&(s=u.value,u=u.parentElement.parentElement,f.cur.storeShowSubid&&u.insertAdjacentHTML("beforeEnd",'<div>Subscription id = <a href="http://steamdb.info/sub/'+s+'">'+s+"</a></div>"),f.cur.storeShowBtnGetPrices&&(c=g("<div><a onclick=\"getPrices(event, '"+n+"', "+r+');return false" href="#getPrices">'+v("getPrices")+"</a></div>"),u=g(u).append(c),l.push({subid:s,el:c[0]})));f.cur.storeShowBtnGetPrices&&(_.getPrices=function(e,n,s){function t(o){var e="app"==n?"app":"package",t="https://store.steampowered.com/api/"+e+"details/?filters=price_overview,packages&v=1&"+e+"ids=";t+=s+"&cc="+o;function a(e){var t="";if(e[s].success){var a=(e=e[s].data).price_overview||e.price;0<a.discount_percent&&(t+="<s>"+a.initial/100+'</s> <span class="discount_pct">-'+a.discount_percent+"%</span> "),t+="<b>"+a.final/100+"</b> "+a.currency,e.packages&&(t+=' (subID:<a href="http://steamdb.info/sub/'+e.packages[0]+'">'+e.packages[0]+"</a>)");try{var i=e.package_groups[0].subs;if(1<i.length)for(var n=1;n<i.length;n++){var r=i[n].option_text.match(/- \D*(\d+(?:[.,]\d{2})?)/i);document.querySelector(".swt_price_"+n+"_"+o+">span").innerHTML="<b>"+r[r.length-1]+"</b> "+a.currency+' (subID:<a href="http://steamdb.info/sub/'+i[n].packageid+'">'+i[n].packageid+"</a>)"}}catch(e){}}else t+="N/A";document.querySelector(".swt_price_0_"+o+">span").innerHTML=t}try{var i=window.GM_xmlhttpRequest||window.GM_xhr;i?i({url:t,method:"GET",anonymous:!0,onload:function(e){e=JSON.parse(e.responseText),a(e)}}):(jQuery.ajaxSettings.xhr=function(){try{return new _.XMLHttpRequest({mozAnon:!0})}catch(e){}},g.ajax({url:t,method:"GET"}).done(a))}catch(e){console.log(e)}}for(var a=0;a<l.length;a++){for(var i=v("prices")+":",r=0;r<_cc.ListA.length;r++)i+='<div class="swt_price_'+a+"_"+_cc.ListA[r]+'"><a href="?cc='+_cc.ListA[r]+'"><img src="//steamcommunity-a.akamaihd.net/public/images/countryflags/'+_cc.ListA[r]+'.gif" style="width:16px"/> '+_cc.ListA[r].toUpperCase()+"</a> <span>...</span></div>";l[a].el.innerHTML=i}for(r=0;r<_cc.ListA.length;r++)t(_cc.ListA[r]);return!1})}var m=document.querySelector(".game_title_area .pageheader")||document.querySelector(".game_title_area .apphub_AppName"),p=encodeURIComponent(m.textContent.trim()),u=document.querySelector(".rightcol.game_meta_data");links=[{href:"http://steamdb.info/"+n+"/"+r+"/",icon:"https://steamdb.info/static/logos/vector_16px.svg",text:v("viewin")+" SteamDB.info"},{href:"http://www.steamprices.com/"+_cc.curCC.toLowerCase()+"/"+n+"/"+r,icon:"https://www.steamprices.com/assets/images/favicons/favicon-16x16.png",text:v("viewin")+" SteamPrices.com"},{href:"https://plati.market/asp/find.asp?ai=111350&searchstr="+p,icon:"https://plati.market/favicon.ico",text:v("searchin")+" Plati.market"},{href:"https://steampub.ru/search/"+p,icon:"https://steampub.ru/favicon.ico",text:v("searchin")+" SteamPub.ru"},{href:"http://www.steamgifts.com/giveaways/search?q="+p,icon:"https://cdn.steamgifts.com/img/favicon.ico",text:v("searchin")+" SteamGifts.com"},{href:"https://steambroker.com/tradeoffers.php?appid=753&refid=42362508&query="+p,icon:"https://steambroker.com/favicon.ico",text:v("searchin")+" SteamBroker.com"},{href:"http://steam-trader.com/games/?r=45962&text="+p,icon:"https://steam-trader.com/favicon.ico",text:v("searchin")+" Steam-Trader.com"}],"app"==n&&(links.push({href:"//steamcommunity.com/my/gamecards/"+r,icon:"//steamstore-a.akamaihd.net/public/images/v6/ico/ico_cards.png",text:v("viewMyCardsGame")}),links.push({href:"//steamcommunity.com/market/search?q=&category_753_Game%5B%5D=tag_app_"+r+"&category_753_item_class%5B%5D=tag_item_class_2&appid=753",icon:"//steamstore-a.akamaihd.net/public/images/v6/ico/ico_cards.png",text:v("SearchCardsOnMarket")})),u.insertAdjacentHTML("afterBegin",function(e,t){for(var a,i='<div class="block">\t\t\t<div class="block_header"><h4>'+e+'</h4></div>\t\t\t<div class="block_content"><div class="block_content_inner">',n=0;n<t.length;n++)a=t[n],i+='<div class="game_area_details_specs"><div class="icon"><a href="'+a.href+'"><img style="height:16px" src="'+a.icon+'" referrerpolicy="no-referrer"></a></div><a class="name" href="'+a.href+'">'+a.text+"</a></div>";return i+="</div></div></div>"}("Steam Web Tools",links));var h=_.addToCart;_.addToCart=function(e){var t=g('[name="add_to_cart_'+e+'"]'),a=t.parent(),i=_.localStorage.swtcarthistory&&JSON.parse(_.localStorage.swtcarthistory)||[];if(20<=i.length&&i.shift(),i.push({subid:e,name:a.find("h1").text().match(/\S+\s(.+)/i)[1],price:a.find(".game_purchase_price.price").text().trim()||a.find(".discount_final_price").text().trim(),link:n+"/"+r}),_.localStorage.swtcarthistory=JSON.stringify(i),!f.cur.storeCartAjax)return h.apply(this,arguments);a.find(".game_purchase_action_bg .btn_addtocart:last>a").after('<a id="swtcartdone" href="#">'+v("adding")+"</a>"),g.ajax({url:t.attr("action"),type:"POST",data:{subid:e,action:"add_to_cart",sessionid:_.g_sessionID}}).done(function(e){var t=-1==e.indexOf('id="error_box"')?"✔ "+v("added"):"❌ Some Error";a.find("#swtcartdone").css("background-image","none").text(t).attr("href","/cart/")})};u=g({app:".game_header_image_full",sub:".package_header"}[n]).wrap(g('<a href="#viewlogos" title="View Logos"></a>').click(function(){var e=".jpg",t=["capsule_616x353"+e,"header"+e,"capsule_467x181"+e,"header_292x136"+e,"capsule_231x87"+e,"capsule_184x69"+e,"capsule_sm_120"+e];"sub"==n?t.unshift("header_586x192"+e):"app"==n&&(t=t.concat(["library_600x900_2x"+e,"library_600x900"+e,"logo.png","library_hero"+e]));for(var a="",i=0;i<t.length;i++)a+='<img src="//steamcdn-a.akamaihd.net/steam/'+n+"s/"+r+"/"+t[i]+'"><br>';return _.ShowDialog(v("Logos"),g(a)),!1}))}else g(".icon.discounts").parent().after('<a class="gutter_item" href="http://steamdb.info/sales/"><span class="icon discounts"></span><span> SteamDB.Info/Sales</span></a>')}()}},{match:[i+"id/[^/]+/?",i+"profiles/\\d+/?"],run:function(){var u,h=_.$J;function o(e){document.querySelector(e).insertAdjacentHTML("afterBegin",'<div id="swt_badges"><a id="csmbadge" class="badge" href="http://checkrep.ru/#steam:'+u+'">CRep: <span></sapn></a> <a id="srbadge" class="badge" href="http://steamrep.com/profiles/'+u+'">SR: <span></sapn></a></div>');var i={0:{text:"rep.unk",color:"606060"},1:{text:"rep.mdlman",color:"5E931B"},2:{text:"rep.white",color:"247E9E"},3:{text:"rep.black",color:"9E2424"},4:{text:"rep.orange",color:"B47200"},error:{text:"Error",color:"606060"}};try{(window.GM_xmlhttpRequest||window.GM_xhr)({method:"GET",url:"http://checkrep.ru/api/swt9Hk02yFhf/0/repforext2/"+u,onload:function(e){var t,a;0<=(t=JSON.parse(e.responseText)).csm||(t.csm="error"),h("#csmbadge")[0].style.background="#"+i[t.csm].color,h("#csmbadge span").text(v(i[t.csm].text)),a=t.srcom?-1<t.srcom.indexOf("SCAMMER")?i[3].color:-1<t.srcom.indexOf("CAUTION")?i[4].color:-1<t.srcom.indexOf("MIDDLEMAN")?i[1].color:-1<t.srcom.indexOf("TRUSTED SELLER")||-1<t.srcom.indexOf("ADMIN")?i[2].color:i[0].color:(t.srcom=v(i[0].text),i[0].color),h("#srbadge")[0].style.background="#"+a,h("#srbadge span").text(t.srcom),h("#swt_badges").show()}})}catch(e){console.log(e)}}_.g_rgProfileData&&function(){_.$J(".profile_header_badgeinfo_badge_area .persona_level").unwrap();var e=[{href:"http://checkrep.ru/#steam:"+(u=_.g_rgProfileData.steamid),icon:"//checkrep.ru/favicon.ico",text:v("checkin")+" CheckRep.ru"},{href:"http://steamrep.com/profiles/"+u,icon:"//steamrep.com/favicon.ico",text:v("checkin")+" SteamRep.com"},{hr:!0},{href:"http://forums.steamrep.com/search/search?keywords="+u,icon:"//steamrep.com/favicon.ico",text:v("searchinforums")+" SteamRep.com"},{href:"http://www.google.com/#q="+u+" inurl:sourceop.com",icon:"//www.sourceop.com/themes/hl2/images/favicon.ico",text:v("searchinforums")+" SourceOP.com"},{href:"http://www.steamtrades.com/user/"+u,icon:"https://cdn.steamtrades.com/img/favicon.ico",text:v("profile")+" SteamTrades.com"},{hr:!0},{href:"http://backpack.tf/profiles/"+u,icon:"//backpack.tf/favicon_440.ico",text:v("inventory")+" Backpack.tf"},{href:"http://tf2b.com/tf2/"+u,icon:"//tf2b.com/favicon.ico",text:v("inventory")+" TF2B.com"},{hr:!0},{href:"http://dota2lounge.com/profile?id="+u,icon:"//dota2lounge.com/favicon.ico",text:v("trades")+" Dota2Lounge.com"},{href:"http://csgolounge.com/profile?id="+u,icon:"//csgolounge.com/favicon.ico",text:v("trades")+" CSGOLounge.com"},{href:"http://steam.tools/itemvalue/#/"+u+"-730",icon:"//steam.tools/favicon.ico",text:v("inventory")+" Steam.tools/itemvalue/"},{hr:!0},{id:"inv_spub",href:"http://steampub.ru/user/"+u,icon:"//steampub.ru/favicon.ico",text:v("profile")+" SteamPub.ru"},{hr:!0}];document.body.insertAdjacentHTML("afterBegin","<style>#swt_badges{display:none;position:absolute;top:7px}.badge{border-radius:3px;box-shadow:1px 1px 0px 0px #1D1D1D;font-size:.7em;padding:3px}#swt_info{position:absolute;top:201px}</style>"),h(".profile_header").append('<div id="swt_info">SteamID64: <a href="https://steamcommunity.com/profiles/'+u+'">'+u+'</a> | <a href="#getMoreInfo" onclick="getMoreInfo();return false">'+v("getMoreInfo")+"</a></div>"),o(".profile_header"),_.getMoreInfo=function(){var p=_.ShowDialog(v("extInfo"),h('<div id="swtexinfo"><img src="//steamcommunity-a.akamaihd.net/public/images/login/throbber.gif"></div>'));_.setTimeout(function(){p.AdjustSizing()},1),h.ajax({url:_.location.href+"?xml=1",context:document.body,dataType:"xml"}).done(function(e,t,a){var i=h(a.responseXML),n=i.find("isLimitedAccount").text(),r=i.find("tradeBanState").text(),o=i.find("vacBanned").text(),s=i.find("memberSince").text(),c=parseInt(u.substr(-10),10),l=c%2,d=c-7960265728;function m(e,t){return"<tr><td><b>"+e+"</b></td><td>"+t+"</td>"}c="STEAM_0:"+l+":"+(d-l)/2,h("#swtexinfo").html("<table>"+m("CommunityID",u)+m("SteamID",c)+m("AccountID",d)+m("Registration date",s)+m("VAC","0"==o?"Clear":"Banned")+m("Trade Ban",r)+m("Is Limited Account","0"==n?"No":"Yes")+"</table>"),_.setTimeout(function(){p.AdjustSizing()},1)}).fail(function(){h("#swtexinfo").html(v("reqErr"))})};try{var t=h('.profile_header_actions>a.btn_profile_action[href^="javascript:OpenFriendChat"]')[0];t.outerHTML='<span class="btn_profile_action btn_medium"><span><a href="steam://friends/message/'+u+'">'+v("chat")+': Steam</a> | <a href="'+t.href+'">Web</a></span></span>',_.OpenFriendChat=_.OpenFriendChatInWebChat}catch(e){}var a=document.querySelector('.profile_count_link a[href$="inventory/"]');a&&a.insertAdjacentHTML("afterEnd",': <span class="linkActionSubtle"><a title="Steam Gifts" href="'+a.href+'#753_1"><img src="//steamstore-a.akamaihd.net/public/images/icon_gift.png"/></a> <a title="Steam Cards" href="'+a.href+'#753_6"><img width="26" height="16" src="//steamstore-a.akamaihd.net/public/images/v6/ico/ico_cards.png"/></a> <a title="TF2" href="'+a.href+'#440"><img src="//steamcdn-a.akamaihd.net/apps/tf2/blog/images/favicon.ico"/></a> <a title="Dota 2" href="'+a.href+'#570"><img src="//www.dota2.com/images/favicon.ico"/></a> <a title="CSGO" href="'+a.href+'#730"><img width="16" height="16" src="//steamcdn-a.akamaihd.net/steamcommunity/public/images/apps/730/69f7ebe2735c366c65c0b33dae00e12dc40edbe4.jpg"/></a></span>');for(var i,n="",r=0;r<e.length;r++)(i=e[r]).hr?n+="<hr/>":n+='<a class="popup_menu_item" href="'+i.href+'"><img style="width:18px;height:18px" src="'+i.icon+'"> '+i.text+"</a>";try{document.querySelector("#profile_action_dropdown>.popup_body.popup_menu").insertAdjacentHTML("afterBegin",n)}catch(e){h(".profile_header_actions").append("<span class=\"btn_profile_action btn_medium\" onclick=\"ShowMenu(this,'profile_action_dropdown','right')\"><span>"+v("more")+' <img src="//steamcommunity-a.akamaihd.net/public/images/profile/profile_action_dropdown.png"/></span></span><div class="popup_block" id="profile_action_dropdown" style="visibility:visible;display:none"><div class="popup_body popup_menu">'+n+"</div></div>")}}()}},{match:[i+"id/.+?/inventory.*",i+"profiles/\\d+/inventory.*"],run:function(){var d=_.$J;if(_.g_strInventoryLoadURL){if(!_.CInventory.prototype.LoadCompleteInventory)return;!function(){var a="swt_notdup",i={descriptions:[]};if(_.getSubid=function(e){i.element=e;var t=_.g_ActiveInventory.selectedItem;i.classid=t.classid,i.giftId=t.assetid,i.giftName=encodeURIComponent(t.description.name),new _.Ajax.Request("//steamcommunity.com/gifts/"+i.giftId+"/validateunpack",{method:"post",parameters:{sessionid:_.g_sessionID},onSuccess:function(e){_.setSubID(e.responseJSON.packageid)}})},_.setSubID=function(e){var t='SubscriptionID = <a href="http://steamdb.info/sub/'+e+'">'+e+"</a>";i.element.outerHTML=t;var a=i.descriptions[i.classid];a[a.length-1]={value:t,type:"html"},a.withSubid=!0},document.body.insertAdjacentHTML("afterBegin","<style>.checkedForSend{background:#366836!important}.itemcount{background:#292929;color:#FFF;font-weight:700;position:absolute;right:0;top:0}.swt_icon{position:absolute;top:0;left:0}.swt_icon-st{background:#CF6A32;color:#fff}.swt_icon-t{background:#FDEC14;color:#000}#inventory_logos{display:none}.swt_hidden{display:none}</style>"),_.checkedForSend={},_.checkForSend=function(e){var t=_.g_ActiveInventory.selectedItem;if(t.checkedForSend)if(t.checkedForSend=!1,t.element.removeClassName("checkedForSend"),1<t._amount)for(var a=0;a<t._amount;a++)delete _.checkedForSend[t._ids[a]];else delete _.checkedForSend[e];else{var i=1;if(1<t._amount&&(i=parseInt(prompt(v("howmany")+t._amount,t._amount))||1)>t._amount&&(i=t._amount),1<i)if(confirm(v("skipSent")))for(a=0;a<i;a++){var n=t._subItems[a],r=!1;if(n.description.owner_descriptions)for(var o=0;o<n.description.owner_descriptions.length;o++)if(n.description.owner_descriptions[o].value.match(/data-miniprofile=|\S+@\S+/i)){r=!0;break}r||(_.checkedForSend[t._subItems[a].assetid]=t.description.name,t._subItems[a].element.addClassName("checkedForSend"))}else for(var a=0;a<i;a++)_.checkedForSend[t._ids[a]]=t.description.name,t._subItems[a].element.addClassName("checkedForSend");else _.checkedForSend[e]=t.description.name,t.checkedForSend=!0,t.element.addClassName("checkedForSend")}},_.sendChecked=function(){var e="https://store.steampowered.com/checkout/sendgift/";for(var t in _.checkedForSend)break;e+=t+"#multisend="+encodeURIComponent(JSON.stringify(_.checkedForSend)),_.location.href=e},_.g_bViewingOwnProfile){var t=_.localStorage.giftsNotes;t=t?JSON.parse(t):{},_.loadGiftNote=function(){var e=_.g_ActiveInventory.selectedItem.assetid;d("#iteminfo"+_.iActiveSelectView+"_item_tags_content textarea.giftnote").length||d("#iteminfo"+_.iActiveSelectView+"_item_tags_content").append('<br/><textarea class="giftnote" style="width:100%">'+(t[e]||"")+"</textarea><button onclick=\"saveGiftNote('"+e+"')\">"+v("save")+"</button>")},_.saveGiftNote=function(e){t[e]=d("#iteminfo"+_.iActiveSelectView+"_content textarea.giftnote").val(),_.localStorage.giftsNotes=JSON.stringify(t)};var e=d("div.pending_gift:first");e.length&&(e.before('<a id="swt_acceptAllGifts" class="btn_darkblue_white_innerfade btn_medium new_trade_offer_btn" href="#"><span>'+v("acceptAllToInv")+"</span></a>"),d("#swt_acceptAllGifts").click(function(e){e.preventDefault();var t=d("div.pending_gift");if(t.length){var a;t=t.find('>div[id^="pending_gift_"]');for(var i=0;i<t.length;i++)a=t[i].id.split("_")[2],DoAcceptGift(a,!1)}}))}var n=_.BuildHover;if(_.BuildHover=function(e,t,a){return _.g_ActiveInventory&&753==_.g_ActiveInventory.appid&&(1!=t.contextid||t.description&&t.description.descriptions&&t.description.descriptions.withClassid||(t.description.descriptions||(t.description.descriptions=[]),t.description.descriptions.withClassid=!0,t.description.descriptions.push({value:"ClassID = "+t.classid}),_.g_bViewingOwnProfile&&t.description.descriptions.push({value:'<a href="#" onclick="getSubid(event.target);return false">'+v("get")+" SubscriptionID</a>",type:"html"}),i.descriptions[t.classid]||(i.descriptions[t.classid]=t.description.descriptions),t.description.owner_actions&&(t.description.owner_actions.push({link:'javascript:checkForSend("%assetid%")',name:v("checkForSend")}),t.description.owner_actions.push({link:"javascript:sendChecked()",name:v("sendChecked")}),t.description.owner_actions.push({link:"javascript:loadGiftNote()",name:v("showNote")})))),n.apply(this,arguments)},!_.g_bViewingOwnProfile){var r=_.PopulateMarketActions;_.PopulateMarketActions=function(e,a){var t=r.apply(this,arguments),i=a.description;if(!i.marketable)return t;var n=i.market_hash_name||i.market_name;return e.appendChild(_.CreateMarketActionButton("blue","http://steamcommunity.com/market/listings/"+a.appid+"/"+n,v("minMarketPrice")+': <span id="swt_lowestItemPrice_'+a.classid+'">?</span>')),d(e).css("display","block"),d.ajax({url:"//steamcommunity.com/market/priceoverview/",type:"GET",data:{country:_.g_strCountryCode,currency:void 0!==_.g_rgWalletInfo?_.g_rgWalletInfo.wallet_currency:1,appid:a.appid,market_hash_name:n}}).done(function(e){var t=v("reqErr");e.success&&(t=e.lowest_price),d("#swt_lowestItemPrice_"+a.classid).html(t)}).fail(function(e){d("#swt_lowestItemPrice_"+a.classid).text(v("reqErr"))}),t}}_.Filter.MatchItemTerms_old=_.Filter.MatchItemTerms,_.Filter.MatchItemTerms=function(e,t){var a=this.MatchItemTerms_old.apply(this,arguments);if(a)return a;for(var i=e.rgItem.description.tags,n=0;n<t.length;n++){var r=!1;if(!r&&i&&i.length)for(var o=0;o<i.length;o++)if(i[o].internal_name&&i[o].internal_name.match(t[n])){r=!0;break}if(!r)return!1}return!0},_.Filter.UpdateTagFiltering_old=_.Filter.UpdateTagFiltering,_.Filter.UpdateTagFiltering=function(e){return _.localStorage.hideDupItems&&(e.SWT=[a]),this.UpdateTagFiltering_old.apply(this,arguments)},_.Filter.MatchItemTags_old=_.Filter.MatchItemTags,_.Filter.MatchItemTags=function(e,t){return t&&t[0]==a?0<e.rgItem._amount||1<e.rgItem.amount:this.MatchItemTags_old.apply(this,arguments)},_.CInventory.prototype.show_old=_.CInventory.prototype.show,_.CInventory.prototype.show=function(){var e=_.CInventory.prototype.show_old.apply(this,arguments);return o(),e};var o=function(){if(_.localStorage.hideDupItems){_.Filter.rgCurrentTags.SWT=[a];_.g_ActiveInventory.LoadCompleteInventory().done(function(){_.Filter.OnFilterChange(),_.g_ActiveInventory._hideDupCounters?d(".itemcount",_.g_ActiveInventory.m_$Inventory).show():(d(".itemcount",_.g_ActiveInventory.m_$Inventory).each(function(e,t){var a,i=d(t);if(_.g_ActiveInventory.m_rgChildInventories)for(var n in a={},_.g_ActiveInventory.m_rgChildInventories)d.extend(a,_.g_ActiveInventory.m_rgChildInventories[n]._firstItems);else a=_.g_ActiveInventory._firstItems;i.text("x"+a[i.data("classid")]._amount).show()}),_.g_ActiveInventory._hideDupCounters=!0)})}else delete _.Filter.rgCurrentTags.SWT,_.Filter.rgLastTags.SWT=[a],_.Filter.OnFilterChange(),d(".itemcount").hide();_.g_ActiveInventory.selectedItem&&_.g_ActiveInventory.EnsurePageActiveForItem(_.g_ActiveInventory.selectedItem.element)};_.onchangehidedup=function(e){e.target.checked?_.localStorage.hideDupItems=1:_.localStorage.removeItem("hideDupItems"),o()};var s=function(){_.g_ActiveInventory&&_.g_ActiveInventory.m_bActive?o():setTimeout(s,1e3)};s(),_.CInventory.prototype.BuildItemElement_old=_.CInventory.prototype.BuildItemElement,_.CInventory.prototype.BuildItemElement=function(e){var t,a=_.CInventory.prototype.BuildItemElement_old.apply(this,arguments);if(730==e.appid){for(var i='<div class="swt_icon">',n=e.description.tags,r=0;r<n.length;r++)switch(n[r].category){case"Quality":switch(n[r].internal_name){case"strange":i+='<span class="swt_icon-st">ST</span>';break;case"unusual":a.css("border-color","#"+n[r].color),n.colored=!0;break;case"tournament":i+='<span class="swt_icon-t">S</span>'}break;case"Rarity":n.colored||a.css("border-color","#"+n[r].color)}a.append(i+"</div>")}if(!e.is_stackable)return this._firstItems||(this._firstItems={}),(t=this._firstItems[e.classid])?(t._amount++,t._ids.push(e.assetid),t._subItems.push(e)):(e._amount=1,e._is_stackable=!0,e._subItems=[e],e._ids=[e.assetid],this._firstItems[e.classid]=e,a.append('<div class="itemcount" data-classid="'+e.classid+'"></div>'),e.description.tags.push({category:"SWT",internal_name:"swt_notdup",localized_category_name:"Steam Web Tools",localized_tag_name:"Hide Dup"})),a},_.CInventory.prototype.SetActivePage_old=_.CInventory.prototype.SetActivePage,_.CInventory.prototype.SetActivePage=function(e){e>=this.m_cPages||(this.m_rgPages[this.m_iCurrentPage].hide(),this.m_rgPages[e].show(),this.m_iCurrentPage=e,this.UpdatePageCounts(),this.PreloadPageImages(this.m_iCurrentPage))},d("#inventory_pagecontrols").before('<label><input type="checkbox" name="hidedup" onchange="window.onchangehidedup(event)" '+(_.localStorage.hideDupItems?'checked="true"':"")+"/>"+v("hideDup")+"</label>"),setTimeout(function(){if(_.SortItem){var e=_.SortItem;_.SortItem=function(){_.$J("#Lnk_SortItems").data("asc")&&e.apply(_,arguments)}}},1500),d("#market_sell_dialog_accept_ssa").prop("checked",!0),d("#market_sell_dialog_input_area").before('<div style="text-align:right;margin-bottom:0.5em;"><a href="#" id="swt_setpricebtn">['+v("setlowestprice")+" -0,01]</a></div>"),d("#swt_setpricebtn").click(function(e){e.preventDefault();var t=_.SellItemDialog.m_item,a=GetMarketHashName(t.description);new _.Ajax.Request("//steamcommunity.com/market/priceoverview/",{method:"get",parameters:{country:_.g_strCountryCode,currency:void 0!==_.g_rgWalletInfo?_.g_rgWalletInfo.wallet_currency:1,appid:t.appid,market_hash_name:a},onSuccess:function(e){if(e.responseJSON&&e.responseJSON.success){var t=_.GetPriceValueAsInt(e.responseJSON.lowest_price);t--,d("#market_sell_buyercurrency_input").val(_.v_currencyformat(t,_.GetCurrencyCode(_.g_rgWalletInfo.wallet_currency))),_.SellItemDialog.OnBuyerPriceInputKeyUp()}}})});var c={};c.el=d("#market_sell_dialog_item_availability_hint>.market_dialog_topwarning"),c.orgnText=c.el.text(),_.SellItemDialog.OnConfirmationAccept_old=_.SellItemDialog.OnConfirmationAccept,_.SellItemDialog._swt_OnConfirmationAccept_next=_.SellItemDialog.OnConfirmationAccept,_.SellItemDialog.OnConfirmationAccept=function(t){if(!f.cur.invSellItemPriceCheckMaxDiscount)return _.SellItemDialog._swt_OnConfirmationAccept_next.call(_.SellItemDialog,t);var e=_.SellItemDialog.m_item,a=GetMarketHashName(e.description);d.ajax({url:"//steamcommunity.com/market/priceoverview/",type:"GET",data:{country:_.g_strCountryCode,currency:void 0!==_.g_rgWalletInfo?_.g_rgWalletInfo.wallet_currency:1,appid:e.appid,market_hash_name:a}}).done(function(a){var i;try{if(!a.success)throw 0;if(!(i=GetPriceValueAsInt(a.lowest_price)||100*(a.lowest_price=_.SellItemDialog.m_plotPriceHistory.data[0].max()[1])))throw 0}catch(e){return void(confirm(v("sellLowPriceCheck.warnTitle")+v("sellLowPriceCheck.loadErr"))&&_.SellItemDialog._swt_OnConfirmationAccept_next.call(_.SellItemDialog,t))}var n=_.SellItemDialog.GetBuyerPriceAsInt(),r=100*(1-n/i);(i-n<=2||r<f.cur.invSellItemPriceCheckMaxDiscount||function(){var e=v("sellLowPriceCheck.warnTitle")+v("sellLowPriceCheck.warning")+"\nyour price: "+_.$("market_sell_buyercurrency_input").value+" ("+_.$("market_sell_currency_input").value+") \ncurrent price: "+a.lowest_price+" \nyour lower at "+Math.round(r)+"% = "+(i-n)/100;if(r>5+f.cur.invSellItemPriceCheckMaxDiscount){var t=prompt(e+"\n"+v("sellLowPriceCheck.warning2")+": "+_.$("market_sell_buyercurrency_input").value);return GetPriceValueAsInt(t)==n?1:void alert(v("sellLowPriceCheck.warnTitle")+"❌")}return confirm(e)}())&&_.SellItemDialog._swt_OnConfirmationAccept_next.call(_.SellItemDialog,t)}).fail(function(){confirm(v("sellLowPriceCheck.warnTitle")+v("sellLowPriceCheck.loadErr"))&&_.SellItemDialog._swt_OnConfirmationAccept_next.call(_.SellItemDialog,t)})};var l=_.SellCurrentSelection;_.SellCurrentSelection=function(){c.el.text(c.orgnText);var e=l.apply(this,arguments),t=_.g_ActiveInventory.selectedItem._amount;if(_.$("market_sell_dialog_ok").stopObserving(),d("#market_sell_dialog_ok").unbind(),1<t){var a=parseInt(prompt(v("howmany")+t,t))||1;1<(a=Math.min(a,t))?(_.SellItemDialog._amount=a,_.SellItemDialog._itemNum=0,_.SellItemDialog._itemsFailNum=0,_.SellItemDialog.OnConfirmationAccept_new=function(e){var t;for(_.$("market_sell_dialog_error").hide(),_.$("market_sell_dialog_ok").fade({duration:.25}),_.$("market_sell_dialog_back").fade({duration:.25}),_.$("market_sell_dialog_throbber").show(),_.$("market_sell_dialog_throbber").fade({duration:.25,from:0,to:1});t=_.SellItemDialog.m_item._subItems[_.SellItemDialog._itemNum],_.SellItemDialog._itemNum++,!t.description.marketable;);_.SellItemDialog.m_item.assetid=t.assetid,d.ajax({url:"https://steamcommunity.com/market/sellitem/",type:"POST",data:{sessionid:_.g_sessionID,appid:_.SellItemDialog.m_item.appid,contextid:_.SellItemDialog.m_item.contextid,assetid:_.SellItemDialog.m_item.assetid,amount:_.SellItemDialog.m_nConfirmedQuantity,price:_.SellItemDialog.m_nConfirmedPrice},crossDomain:!0,xhrFields:{withCredentials:!0}}).done(function(e){if(c.el.text(v("listed")+_.SellItemDialog._itemNum+" / "+a+(_.SellItemDialog._itemsFailNum?" | "+v("skipped")+_.SellItemDialog._itemsFailNum:"")),!(_.SellItemDialog._itemNum>=_.SellItemDialog._amount))return _.SellItemDialog.OnConfirmationAccept_new.apply(_.SellItemDialog,arguments);_.SellItemDialog.OnSuccess.apply(_.SellItemDialog,[{responseJSON:e}])}).fail(function(e){var t=d.parseJSON(e.responseText);if(_.SellItemDialog._itemsFailNum++,!(_.SellItemDialog._itemNum>=_.SellItemDialog._amount))return _.SellItemDialog.OnConfirmationAccept_new.apply(_.SellItemDialog,arguments);_.SellItemDialog.OnFailure({responseJSON:t})})},_.SellItemDialog._swt_OnConfirmationAccept_next=_.SellItemDialog.OnConfirmationAccept_new):_.SellItemDialog._swt_OnConfirmationAccept_next=_.SellItemDialog.OnConfirmationAccept_old}else _.SellItemDialog._swt_OnConfirmationAccept_next=_.SellItemDialog.OnConfirmationAccept_old;return d("#market_sell_dialog_ok").on("click",d.proxy(_.SellItemDialog.OnConfirmationAccept,_.SellItemDialog)),e}}()}}},{match:[i+"id/.+?/gamecards/\\d+.*",i+"profiles/\\d+/gamecards/\\d+.*"],run:function(){var n=_.$J,i=_.location.pathname.match(/\/gamecards\/(\d+)/)[1],e=n(".gamecards_inventorylink:first");if(e.length||(e=n('<div class="gamecards_inventorylink"></div>').prependTo(n(".badge_detail_tasks:first")).append('<a class="btn_grey_grey btn_medium" href="/my/gamecards/'+i+'"><span>'+v("viewMyCardsGame")+"</span></a> ")),e.append('<a class="btn_grey_grey btn_small_thin" href="https://steamcommunity.com/market/search?appid=753&category_753_item_class%5B%5D=tag_item_class_5&category_753_Game%5B%5D=tag_app_'+i+'"><span>Booster Pack</span></a> '),e.append('<a class="btn_grey_grey btn_small_thin" href="http://www.steamcardexchange.net/index.php?inventorygame-appid-'+i+'"><span>www.SteamCardExchange.net</span></a> '),n(".badge_craft_button").length){var r=!(_.craftAllAvailable=function(){var e=n(".badge_card_set_text_qty").text().match(/\d+/g).min(),t=0,a=0,i=[];return _.FinishCraft_old=_.FinishCraft,_.FinishCraft=function(){a?1==a&&(g_rgBadgeCraftData&&g_bBadgeCraftAnimationReady&&a++,_.FinishCraft_old()):_.g_rgBadgeCraftData&&(t++,i=i.concat(_.g_rgBadgeCraftData.rgDroppedItems),e<=t?(a=1,r&&_.parent.swt_craftBadgeDone(),_.g_rgBadgeCraftData.rgDroppedItems=i,_.FinishCraft()):n(".badge_craft_button").click())},n(".badge_craft_button").click(),!1});"#swt_craft"==_.location.hash&&(r=!0,_.craftAllAvailable()),e.prepend('<div style="float:right;margin-left:5px" class="btn_grey_black btn_small_thin" onclick="craftAllAvailable()"><span>'+v("craftAllAvailable")+"</span></div>")}n(".badge_friendwithgamecard_actions").each(function(e,t){var a=n(t);a.append('<a class="btn_grey_grey btn_medium" title="Steam Cards" href="'+a.prev("a.persona").attr("href")+"/gamecards/"+i+'"><img style="height:16px;transform:scale(1.5)" src="//steamstore-a.akamaihd.net/public/images/ico/ico_cards.png"></a>')})}},{match:[i+"id/.+?/badges.*",i+"profiles/\\d+/badges.*"],run:function(){var i=_.$J;i(".badge_details_set_favorite").append('<div class="btn_grey_black btn_small_thin" onclick="swt_showWithDrop()"><span>'+v("showDropsCard")+"</span></div> "),_.swt_showWithDrop=function(){return i(".badge_row").filter(function(e,t){return!i("a.btn_green_white_innerfade",t).length}).remove(),!1},i(".badge_craft_button").length&&(_.swt_craftBadgeDone=function(){--_.swt_badgesCount<=0&&(alert(v("done")),_.location.reload())},_.swt_craftAllAvailableBadges=function(){if(confirm(v("craftAllAvailableConfirm"))){var e=i(".badge_craft_button").parents(".badge_row.is_link"),t=e.length;t&&(_.swt_badgesCount=t,e.find("a.badge_row_overlay").each(function(e,t){var a=i(t);a.replaceWith('<iframe scrolling="no" class="badge_row_overlay" style="width:100%;height:100%;overflow:hidden;z-index:5;"src="'+a.attr("href")+'#swt_craft"></iframe>')}))}},i(".badge_details_set_favorite").append('<div class="btn_grey_black btn_small_thin" onclick="swt_craftAllAvailableBadges()"><span>'+v("craftAllAvailable")+"</span></div> "))}},{match:[i+"market.*"],run:function(){function s(){_.$J("#tabContentsMyListings .market_home_listing_table:nth-child(1) .market_listing_table_header>.market_listing_edit_buttons").html('<a href="#checkAllListings" id="btnCheckAllListings" class="item_market_action_button item_market_action_button_blue"><span class="item_market_action_button_edge item_market_action_button_left"></span><span class="item_market_action_button_contents">'+v("checkAll")+'</span><span class="item_market_action_button_edge item_market_action_button_right"></span></a> <a href="#removeListings" id="btnRemoveListings" class="item_market_action_button item_market_action_button_green"><span class="item_market_action_button_edge item_market_action_button_left"></span><span class="item_market_action_button_contents">'+v("deleteChecked")+'</span><span class="item_market_action_button_edge item_market_action_button_right"></span></a>'),_.$J("#btnCheckAllListings").click(function(){return _.$J(".lfremove").attr("checked",!_.$J(".lfremove:first")[0].checked),!1}),_.$J("#btnRemoveListings").click(function(){var a=[];return _.$J(".lfremove").each(function(e,t){t.checked&&a.push(t)}),a.length&&function e(t){t<a.length&&new _.Ajax.Request("//steamcommunity.com/market/removelisting/"+_.$J(a[t]).data("listingid"),{method:"post",parameters:{sessionid:_.g_sessionID},onComplete:function(){e(++t)},onSuccess:function(){a[t].parentElement.parentElement.parentElement.parentElement.remove()}})}(0),!1}),_.$J(".market_listing_cancel_button a").each(function(e,t){var a=decodeURIComponent(String(t.href)).match(/mylisting', '(\d+)', (\d+), '(\d+)', '(\d+)'/i);if(a){var i=_.$J(t);i.before('<span class="item_market_action_button_contents"><input type="checkbox" class="lfremove" data-listingid="'+a[1]+'"/></span>'),i.remove()}})}function c(){_.$J("#searchResults_btn_next").after(' <input id="swt_gotopagevl" type="text" value="1" size="3"/><span class="pagebtn" id="swt_gotopagebtn">'+v("go")+"</span>"),_.$J("#swt_gotopagebtn").click(function(){_.g_oSearchResults.GoToPage(_.$("swt_gotopagevl").value-1)})}var e;f.cur.globalHideWalletBalance&&(e=_.$J("#marketWalletBalanceAmount")[0])&&(e.title=e.innerHTML,e.innerHTML="["+v("balance")+"]"),(e=_.$J(".pick_and_sell_button").length)?f.cur.marketMainPageFuncs&&(document.body.insertAdjacentHTML("afterBegin","<style>.scrollbl{max-height:500px;overflow-y:scroll;} .lfremove{display:inline-block}</style>"),s()):document.getElementById("searchResults")?c():document.getElementById("largeiteminfo_item_name")&&function(){_.$J("#market_buynow_dialog_accept_ssa, #market_buyorder_dialog_accept_ssa").prop("checked",!0),c(),s(),_.$J("#searchResultsRows .market_listing_item_name_block").each(function(e,t){_.$J(t).prepend('<div style="float:right">#'+(e+1)+"</div>")});var e=_.g_rgAssets;if(!e)return;if(!(e=e[753]&&(e[753][6]||e[753][0])))return;var t=Object.values(e)[0],a=t.owner_actions&&t.owner_actions[0]&&t.owner_actions[0].link;if(!a)return;if(a.match(/\/my\/gamecards\/\d+/))var i={name:"Booster Pack",link:"//steamcommunity.com/market/search?appid=753&category_753_item_class%5B%5D=tag_item_class_5&category_753_Game%5B%5D=tag_app_"+t.market_fee_app};else{if(!(-1<a.indexOf("javascript:OpenBooster")))return;i={name:v("SearchCardsOnMarket"),link:"//steamcommunity.com/market/search?category_753_item_class%5B%5D=tag_item_class_2&appid=753&category_753_Game%5B%5D=tag_app_"+t.market_fee_app}}for(var n=_.$J('<div class="item_actions" id="largeiteminfo_item_actions"></div>').insertAfter(_.$J("#largeiteminfo_game_info")),r=[i,{name:v("viewMyCardsGame"),link:"//steamcommunity.com/my/gamecards/"+t.market_fee_app}],o=r.length;0<o;--o,n.append('<a class="btn_small btn_grey_white_innerfade" href="'+r[o].link+'"><span>'+r[o].name+"</span></a>"));}()}},{match:[i+"groups/SteamClientBeta#?/?/swt-settings"],run:function(){var o=_.$J;o("#group_tab_content_overview").show().attr("id","swt_content1"),o("head").append(o('<link href="//steamcommunity-a.akamaihd.net/public/css/skin_1/groupadmin.css" rel="stylesheet" type="text/css">')),o(".grouppage_logo").css("background-image","none"),o(".grouppage_logo>img")[0].src="//v1t.su/projects/steam/webtools/imgs/steam-big-icon.png",o(".grouppage_header_label").text("Steam "+v("set.ext"));var e=o(".grouppage_header_name").html('Steam Web Tools <span class="grouppage_header_abbrev" style="font-size:21px">'+v("set.settings")+"</span>"),t="https://v1t.su/projects/steam/webtools/",a=o(".grouppage_join_area a");a.length?(a[0].href=t,a.find("span").text(v("set.homePage"))):e.after('<div class="grouppage_join_area"><a href="'+t+'" class="btn_green_white_innerfade btn_medium"><span>'+v("set.homePage")+"</span></a></div>"),o(".grouppage_friendsingroup").remove(),o(".grouppage_member_tiles").remove(),o(".group_tabs").remove(),o(".rightcol ").remove();var s=function(e){var t,a,i,n,r="";for(s.fields=[],i=0;i<e.length;i++){for(r+=s.create_groupStart(e[i].group),t=e[i].rows,n=0;n<t.length;n++)a=t[n],s.fields.push(a.name),a.value=f.cur[a.name],r+='<div class="formRow">',r+=s["create_"+a.type](a),r+="</div>";r+=s.create_groupEnd()}o(".maincontent>.leftcol ")[0].innerHTML='<form class="smallForm" id="editForm" name="editForm">'+r+'<div class="group_content_bodytext"><div class="forum_manage_actions"><a href="#/swt-settings" class="btn_grey_white_innerfade btn_medium" id="swt_btnDef"><span>'+v("set.def")+'</span></a><button type="submit" class="btn_green_white_innerfade btn_medium"><span>'+v("save")+"</span></button></div></div></form>"};s.create_groupStart=function(e){return'<div class="group_content group_summary"><div class="formRow"><h1>'+e+"</h1></div>"},s.create_groupEnd=function(){return"</div>"},s.create_checkbox=function(e){return'<input type="checkbox"'+(e.value?' checked="checked"':"")+' name="'+e.name+'" id="'+e.name+'"><label for="'+e.name+'">'+e.title+"</label>"},s.create_select=function(e){for(var t='<div class="formRowTitle">'+e.title+'</div><div class="formRowFields"><select name="'+e.name+'" id="'+e.name+'" class="gray_bevel">',a=e.options,i=0;i<a.length;i++)t+='<option value="'+a[i].value+'"'+(a[i].value==e.value?' selected="selected"':"")+">"+a[i].text+"</option>";return t+="</select></div>"},s.create_textLong=function(e){return"<div>"+e.title+'</div><div class="formRowFields"><div class="gray_bevel for_text_input fullwidth"><input type="text" name="'+e.name+'" id="'+e.name+'" value="'+e.value+'"></div></div>'},s.create_number=function(e){return'<label for="'+e.name+'">'+e.title+'</label> <input type="number" value="'+e.value+'" min="'+e.min+'" max="'+e.max+'" step="'+e.step+'" name="'+e.name+'" id="'+e.name+'">'},s([{group:v("set.global"),rows:[{type:"select",title:v("set.lang"),name:"globalLang",options:[{text:"English",value:"en"},{text:"Русский",value:"ru"},{text:"简体中文",value:"zh-cn"},{text:"日本語",value:"jp"}]},{type:"checkbox",title:v("set.FixNavbar"),name:"globalFixNavbar"},{type:"checkbox",title:v("set.hideBalance"),name:"globalHideWalletBalance"},{type:"checkbox",title:v("set.linkfilter"),name:"globalDisableLinkFilted"}]},{group:v("set.store"),rows:[{type:"checkbox",title:v("set.showCCBtn"),name:"storeShowCCbtn"},{type:"textLong",title:v("set.CCList"),name:"storeCCList"},{type:"checkbox",title:v("set.showCartBtn"),name:"storeShowCartBtn"},{type:"checkbox",title:v("set.cartAjax"),name:"storeCartAjax"},{type:"checkbox",title:v("set.showSubid"),name:"storeShowSubid"},{type:"checkbox",title:v("set.showBtnGetPrices"),name:"storeShowBtnGetPrices"}]},{group:v("set.market"),rows:[{type:"checkbox",title:v("set.marketMainPageFuncs"),name:"marketMainPageFuncs"},{type:"number",title:v("set.sellLowPriceCheck"),name:"invSellItemPriceCheckMaxDiscount",min:0,max:99,step:1}]}]),o("#swt_btnDef").click(function(){f.reset(),f.save(),f.storage.gm?_.location.reload():_.location.href="https://store.steampowered.com/about/#swt-settings-del"}),o("form#editForm").submit(function(e){var t,a,i,n;for(t=0;t<s.fields.length;t++)a=s.fields[t],n=(i=o("#"+a)).prop("type"),f.cur[a]="checkbox"==n?i.prop("checked"):"number"==n?i.get(0).valueAsNumber:i.val();f.save(),e.preventDefault(),f.storage.gm?_.location.href="https://steamcommunity.com/groups/SteamClientBeta#/swt-settings":_.location.href="https://store.steampowered.com/about/#swt-settings-save="+encodeURIComponent(JSON.stringify(f.cur))})}},{match:[a+"about/#swt-settings.*"],run:function(){var e=_.location.hash;if(e&&"swt-settings-"==e.substr(1,13))if("save"==e.substr(14,4)){var t=e.substr(19);t=decodeURIComponent(t),f.storage.set(t)}else"del"==e.substr(14,3)&&f.storage.del();_.location.href="https://steamcommunity.com/groups/SteamClientBeta#/swt-settings"}},{match:[i+"linkfilter.*"],run:function(){f.cur.globalDisableLinkFilted&&(_.location=_.$J("#proceedButton").attr("href"))}}],r=document.URL,o=0;o<n.length;o++)for(var s=0;s<n[o].match.length;s++){if(new RegExp("^"+n[o].match[s]+"$","i").test(r)){n[o].run();break}}}();